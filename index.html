<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>App Crist√£o</title>

  <!-- PWA (opcional). Se voc√™ j√° tem manifest/webmanifest e sw.js, pode manter. -->
  <meta name="theme-color" content="#0B1220" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="App Crist√£o" />

  <style>
    :root{
      --bg:#070B14;
      --card: rgba(11,18,32,.72);
      --card2: rgba(11,18,32,.62);
      --line: rgba(255,255,255,.10);
      --text:#EAF0FF;
      --muted:#A7B4D6;
      --gold:#E7C56E;
      --good:#45E2A8;
      --warn:#FFD36B;
      --bad:#FF6B6B;
      --btn: rgba(255,255,255,.08);
      --btn2: rgba(255,255,255,.12);
      --shadow: 0 14px 40px rgba(0,0,0,.55);
      --radius: 20px;
      --radius2: 16px;
      --pad: 16px;
      --max: 980px;
      --safeTop: env(safe-area-inset-top);
      --safeBottom: env(safe-area-inset-bottom);
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }

    /* ‚úÖ FUNDO COM SUA IMAGEM */
    body{
      margin:0;
      font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      color:var(--text);
      background:
        linear-gradient(180deg, rgba(2,6,16,.72), rgba(2,6,16,.86)),
        url("imagens/C5782EF9-9488-4CB9-8285-C27D142A8118.png") no-repeat center center fixed;
      background-size:cover;
      overflow-x:hidden;
    }

    /* ‚Äúpel√≠cula‚Äù extra (fica mais leg√≠vel) */
    .veil{
      position:fixed; inset:0;
      background: radial-gradient(1200px 800px at 20% 0%, rgba(71,134,255,.12), transparent 55%),
                  radial-gradient(900px 600px at 80% 10%, rgba(231,197,110,.10), transparent 55%),
                  radial-gradient(900px 900px at 50% 100%, rgba(69,226,168,.07), transparent 60%);
      pointer-events:none;
      z-index:0;
    }

    .wrap{
      position:relative;
      z-index:1;
      min-height:100%;
      display:flex;
      flex-direction:column;
      padding: calc(var(--safeTop) + 18px) 14px calc(var(--safeBottom) + 92px);
    }

    .container{
      width:100%;
      max-width:var(--max);
      margin:0 auto;
    }

    .topbar{
      display:flex;
      align-items:center;
      gap:12px;
      margin-bottom:14px;
    }

    .appicon{
      width:44px;height:44px;
      border-radius:14px;
      background: linear-gradient(135deg, rgba(90,107,255,.9), rgba(231,197,110,.25));
      display:grid;place-items:center;
      box-shadow: var(--shadow);
      border:1px solid rgba(255,255,255,.14);
      flex:0 0 auto;
    }
    .appicon span{
      font-size:22px;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.35));
    }

    .titleblock{ flex:1; min-width:0; }
    .titleblock h1{
      font-size:20px; margin:0; letter-spacing:.2px;
      line-height:1.2;
    }
    .subtitle{
      margin-top:3px;
      font-size:13px;
      color:var(--muted);
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }
    .dot{ opacity:.6; }

    .pill{
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      padding:8px 10px;
      border-radius:999px;
      font-size:12px;
      color:var(--muted);
      display:flex;
      gap:8px;
      align-items:center;
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
    }
    .pill b{ color:var(--text); font-weight:600; }

    .card{
      background: var(--card);
      border:1px solid rgba(255,255,255,.12);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: var(--pad);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      margin-bottom:14px;
    }
    .card.soft{ background: var(--card2); }

    .sectiontitle{
      font-size:13px;
      color: var(--muted);
      letter-spacing:.14em;
      text-transform:uppercase;
      margin:0 0 10px;
    }

    .verse{
      font-size:30px;
      line-height:1.18;
      letter-spacing:-.2px;
      margin:0 0 10px;
    }
    .ref{
      font-size:15px;
      color: var(--muted);
      margin-bottom:12px;
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }
    .btn{
      border:1px solid rgba(255,255,255,.12);
      background: var(--btn);
      color: var(--text);
      padding:11px 14px;
      border-radius:14px;
      font-size:15px;
      cursor:pointer;
      box-shadow: 0 12px 24px rgba(0,0,0,.22);
      transition: transform .08s ease, background .2s ease;
      user-select:none;
    }
    .btn:active{ transform: scale(.98); }
    .btn.primary{ background: rgba(71,134,255,.18); border-color: rgba(71,134,255,.22); }
    .btn.good{ background: rgba(69,226,168,.16); border-color: rgba(69,226,168,.22); }
    .btn.warn{ background: rgba(255,211,107,.16); border-color: rgba(255,211,107,.22); color: #fff; }
    .btn.small{ padding:9px 12px; font-size:14px; border-radius:12px; }

    .box{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      border-radius: 16px;
      padding: 12px;
      margin-top:12px;
    }
    .box h3{
      margin:0 0 6px;
      font-size:18px;
      letter-spacing:.2px;
    }
    .box p{
      margin:0;
      color: var(--muted);
      line-height:1.35;
    }

    .grid2{
      display:grid;
      grid-template-columns: 1fr;
      gap:14px;
    }
    @media(min-width:820px){
      .grid2{ grid-template-columns: 1.1fr .9fr; }
    }

    .input, .textarea, select{
      width:100%;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.12);
      color: var(--text);
      border-radius: 14px;
      padding: 12px 12px;
      outline:none;
      font-size:15px;
    }
    .textarea{ min-height:110px; resize:vertical; }

    .list{
      display:flex;
      flex-direction:column;
      gap:10px;
      margin-top:12px;
    }
    .item{
      background: rgba(0,0,0,.16);
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 16px;
      padding: 12px;
    }
    .item .meta{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      color: var(--muted);
      font-size:13px;
      margin-top:6px;
    }
    .tag{
      padding: 5px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--muted);
      font-size:12px;
    }
    .tag.good{ border-color: rgba(69,226,168,.26); background: rgba(69,226,168,.12); color:#d7ffef; }
    .tag.warn{ border-color: rgba(255,211,107,.26); background: rgba(255,211,107,.12); color:#fff3cf; }

    /* Galeria */
    .gallery{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:12px;
    }
    @media(min-width:700px){
      .gallery{ grid-template-columns: 1fr 1fr 1fr; }
    }
    .gimg{
      border-radius:16px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      box-shadow: 0 14px 30px rgba(0,0,0,.35);
      cursor:pointer;
    }
    .gimg img{
      width:100%;
      height:160px;
      object-fit:cover;
      display:block;
    }
    .gcap{
      padding:10px;
      color: var(--muted);
      font-size:13px;
      border-top:1px solid rgba(255,255,255,.08);
    }

    /* Modal imagem */
    .modal{
      position:fixed; inset:0;
      background: rgba(0,0,0,.70);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:50;
      padding: 18px;
    }
    .modal.open{ display:flex; }
    .modalbox{
      max-width: 980px;
      width:100%;
      background: rgba(11,18,32,.82);
      border: 1px solid rgba(255,255,255,.14);
      border-radius: 22px;
      overflow:hidden;
      box-shadow: 0 25px 60px rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .modalimg{
      width:100%;
      max-height: 70vh;
      object-fit:contain;
      background: rgba(0,0,0,.25);
      display:block;
    }
    .modalbar{
      display:flex;
      gap:10px;
      justify-content:space-between;
      align-items:center;
      padding: 12px;
      border-top:1px solid rgba(255,255,255,.10);
      color: var(--muted);
      font-size:13px;
    }

    /* Tabs bottom */
    .tabs{
      position:fixed;
      left:0; right:0;
      bottom:0;
      padding: 10px 12px calc(var(--safeBottom) + 10px);
      z-index:40;
      background: linear-gradient(180deg, transparent, rgba(0,0,0,.55));
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
    .tabbar{
      width:100%;
      max-width:var(--max);
      margin:0 auto;
      background: rgba(11,18,32,.70);
      border:1px solid rgba(255,255,255,.12);
      border-radius: 20px;
      display:flex;
      justify-content:space-between;
      padding: 10px 8px;
      box-shadow: 0 22px 45px rgba(0,0,0,.55);
    }
    .tab{
      flex:1;
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:6px;
      color: var(--muted);
      font-size:12px;
      padding: 8px 6px;
      border-radius: 16px;
      cursor:pointer;
      user-select:none;
    }
    .tab .ico{ font-size:20px; }
    .tab.active{
      background: rgba(255,255,255,.08);
      color: var(--text);
      border: 1px solid rgba(255,255,255,.10);
    }

    .hidden{ display:none !important; }

    .hint{
      margin-top:10px;
      color: var(--muted);
      font-size:13px;
      line-height:1.35;
    }

    .smallnote{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      margin-top:10px;
      color: var(--muted);
      font-size:13px;
    }
    .smallnote span{ display:flex; gap:8px; align-items:center; }

    .hr{
      height:1px;
      background: rgba(255,255,255,.10);
      margin: 12px 0;
    }
  </style>
</head>

<body>
  <div class="veil"></div>

  <div class="wrap">
    <div class="container">

      <div class="topbar">
        <div class="appicon"><span>‚úùÔ∏è</span></div>
        <div class="titleblock">
          <h1>App Crist√£o</h1>
          <div class="subtitle">
            <span>Seu devocional pessoal</span>
            <span class="dot">‚Ä¢</span>
            <span id="offlineStatus">offline</span>
          </div>
        </div>
        <div class="pill"><span>üü°</span><b id="pendencia">Pend√™ncia</b> <span>hoje</span></div>
      </div>

      <!-- ====== P√ÅGINAS ====== -->

      <!-- HOJE -->
      <section id="page-hoje">
        <div class="card">
          <div class="sectiontitle">HOJE</div>
          <p class="verse" id="verseText">‚Äú...‚Äù</p>
          <div class="ref" id="verseRef">‚Äî</div>

          <div class="row">
            <button class="btn primary" id="btnTrocar">Trocar</button>
            <button class="btn" id="btnCompartilhar">Compartilhar</button>
            <button class="btn" id="btnCopiar">Copiar</button>
          </div>

          <div class="box">
            <h3 id="devTitle">Devocional: ‚Äî</h3>
            <p id="devText">‚Äî</p>

            <div class="smallnote">
              <span>üíæ Salva no seu iPhone</span>
              <span>üüß Funciona offline</span>
              <span>üß© Lembrete: Atalhos</span>
            </div>
          </div>
        </div>

        <div class="card soft">
          <div class="sectiontitle">Plano de leitura</div>
          <div style="display:flex;align-items:flex-start;justify-content:space-between;gap:10px;">
            <div>
              <div style="font-size:22px;font-weight:700;margin-bottom:4px;">Plano ‚Äú30 dias‚Äù</div>
              <div style="color:var(--muted);">Dia <span id="planoDia">1</span> de 30</div>
            </div>
            <div style="color:var(--muted); font-weight:700;" id="planoPct">0%</div>
          </div>

          <div class="row" style="margin-top:12px;">
            <button class="btn good" id="btnFeito">Marcar ‚Äúfeito‚Äù</button>
            <button class="btn" id="btnReiniciar">Reiniciar</button>
          </div>

          <div class="hint">Dica: esse progresso fica salvo no seu iPhone (offline).</div>
        </div>
      </section>

      <!-- ORA√á√ÉO -->
      <section id="page-oracao" class="hidden">
        <div class="card">
          <div class="sectiontitle">Pedidos de ora√ß√£o</div>

          <div class="grid2">
            <div>
              <input class="input" id="prayTitle" placeholder="T√≠tulo (ex: Fam√≠lia, Sa√∫de, Trabalho)" />
              <div style="height:10px;"></div>
              <textarea class="textarea" id="prayText" placeholder="Escreva o pedido..."></textarea>
              <div class="row" style="margin-top:12px;">
                <button class="btn good" id="btnAddPrayer">Salvar pedido</button>
                <button class="btn" id="btnClearPrayerForm">Limpar</button>
              </div>
              <div class="hint">Tudo fica salvo no aparelho (localStorage). N√£o envia pra internet.</div>
            </div>

            <div>
              <div class="box">
                <h3>Vers√≠culo para ora√ß√£o</h3>
                <p id="prayVerse">‚ÄúN√£o andeis ansiosos por coisa alguma...‚Äù (Fp 4:6-7)</p>
                <div class="hr"></div>
                <div class="row">
                  <button class="btn primary small" id="btnNextPrayVerse">Trocar</button>
                  <button class="btn small" id="btnCopyPrayVerse">Copiar</button>
                </div>
              </div>

              <div class="box" style="margin-top:12px;">
                <h3>Checklist r√°pido</h3>
                <p>‚Ä¢ Agradecer ‚Ä¢ Confessar ‚Ä¢ Pedir ‚Ä¢ Interceder ‚Ä¢ Ouvir</p>
                <div class="hint">Voc√™ pode registrar pedidos e marcar como ‚ÄúRespondido‚Äù.</div>
              </div>
            </div>
          </div>

          <div class="list" id="prayerList"></div>
        </div>
      </section>

      <!-- M√öSICA -->
      <section id="page-musica" class="hidden">
        <div class="card">
          <div class="sectiontitle">M√∫sica</div>

          <div class="box">
            <h3>Player</h3>
            <p style="color:var(--muted); margin-bottom:10px;">Cole um link direto de <b>MP3</b> (ex: um arquivo .mp3) e salve na playlist.</p>
            <audio id="player" controls style="width:100%;"></audio>
            <div class="hr"></div>

            <input class="input" id="musicName" placeholder="Nome da m√∫sica (ex: Louvor 1)" />
            <div style="height:10px;"></div>
            <input class="input" id="musicUrl" placeholder="Link direto do mp3 (https://.../musica.mp3)" />
            <div class="row" style="margin-top:12px;">
              <button class="btn good" id="btnAddMusic">Adicionar na playlist</button>
              <button class="btn" id="btnClearMusic">Limpar</button>
            </div>

            <div class="hint">
              ‚ö†Ô∏è YouTube n√£o funciona aqui porque n√£o √© link direto de √°udio.  
              Se voc√™ tiver mp3 no Drive/Dropbox/servidor, a√≠ funciona.
            </div>
          </div>

          <div class="list" id="musicList"></div>
        </div>
      </section>

      <!-- IMAGENS -->
      <section id="page-imagens" class="hidden">
        <div class="card">
          <div class="sectiontitle">Imagens</div>
          <div class="hint">
            Essas imagens ficam dentro do seu reposit√≥rio em <b>/imagens</b>.
            Quando voc√™ enviar mais imagens pro GitHub, √© s√≥ adicionar o nome aqui na lista (no c√≥digo) ou me mandar que eu monto a lista inteira.
          </div>

          <div class="gallery" id="gallery"></div>
        </div>
      </section>

      <!-- NOTAS -->
      <section id="page-notas" class="hidden">
        <div class="card">
          <div class="sectiontitle">Notas</div>
          <input class="input" id="noteTitle" placeholder="T√≠tulo da nota" />
          <div style="height:10px;"></div>
          <textarea class="textarea" id="noteText" placeholder="Escreva aqui..."></textarea>
          <div class="row" style="margin-top:12px;">
            <button class="btn good" id="btnSaveNote">Salvar nota</button>
            <button class="btn" id="btnClearNote">Limpar</button>
          </div>
          <div class="list" id="notesList"></div>
        </div>
      </section>

      <!-- CONFIG -->
      <section id="page-config" class="hidden">
        <div class="card">
          <div class="sectiontitle">Configura√ß√µes</div>

          <div class="box">
            <h3>Fundo do app</h3>
            <p>J√° est√° usando esta imagem:</p>
            <p style="margin-top:6px;color:var(--gold); font-weight:700;">
              imagens/C5782EF9-9488-4CB9-8285-C27D142A8118.png
            </p>
            <div class="hint">Se voc√™ quiser trocar o fundo depois, basta enviar outra imagem para /imagens e mudar o caminho no CSS.</div>
          </div>

          <div class="box" style="margin-top:12px;">
            <h3>Dados do app</h3>
            <p>Pedidos de ora√ß√£o, notas, playlist e progresso ficam salvos no iPhone.</p>
            <div class="row" style="margin-top:12px;">
              <button class="btn warn" id="btnResetAll">Apagar tudo</button>
              <button class="btn" id="btnExport">Exportar (copiar)</button>
            </div>
            <div class="hint">‚ÄúApagar tudo‚Äù remove os dados do armazenamento local do navegador.</div>
          </div>

          <div class="box" style="margin-top:12px;">
            <h3>Ajuda r√°pida</h3>
            <p><b>Se n√£o atualizar:</b> abra com <code>?v=123</code> no final da URL para for√ßar atualiza√ß√£o.</p>
            <p style="margin-top:8px;"><b>Para virar app:</b> Safari ‚Üí Compartilhar ‚Üí ‚ÄúAdicionar √† Tela de In√≠cio‚Äù.</p>
          </div>
        </div>
      </section>

    </div>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modalbox">
      <img id="modalImg" class="modalimg" src="" alt="Imagem" />
      <div class="modalbar">
        <div id="modalCap">‚Äî</div>
        <div class="row">
          <button class="btn small" id="btnCloseModal">Fechar</button>
          <button class="btn small" id="btnCopyImgLink">Copiar link</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <div class="tabbar">
      <div class="tab active" data-tab="hoje"><div class="ico">üè†</div><div>Hoje</div></div>
      <div class="tab" data-tab="oracao"><div class="ico">üôè</div><div>Ora√ß√£o</div></div>
      <div class="tab" data-tab="musica"><div class="ico">üéµ</div><div>M√∫sica</div></div>
      <div class="tab" data-tab="imagens"><div class="ico">üñºÔ∏è</div><div>Imagens</div></div>
      <div class="tab" data-tab="notas"><div class="ico">üìù</div><div>Notas</div></div>
      <div class="tab" data-tab="config"><div class="ico">‚öôÔ∏è</div><div>Config</div></div>
    </div>
  </div>

  <script>
    // ===== Util =====
    const $ = (q) => document.querySelector(q);
    const $$ = (q) => Array.from(document.querySelectorAll(q));

    const store = {
      get(k, fallback){
        try{
          const v = localStorage.getItem(k);
          return v ? JSON.parse(v) : fallback;
        }catch(e){
          return fallback;
        }
      },
      set(k, v){
        localStorage.setItem(k, JSON.stringify(v));
      },
      del(k){
        localStorage.removeItem(k);
      }
    };

    function nowISO(){
      return new Date().toISOString();
    }

    function fmtDate(iso){
      try{
        const d = new Date(iso);
        return d.toLocaleString('pt-BR',{dateStyle:'short', timeStyle:'short'});
      }catch(e){
        return iso;
      }
    }

    async function copyText(t){
      try{
        await navigator.clipboard.writeText(t);
        toast("Copiado!");
      }catch(e){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = t;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        ta.remove();
        toast("Copiado!");
      }
    }

    function toast(msg){
      // toast simples
      const el = document.createElement('div');
      el.textContent = msg;
      el.style.position='fixed';
      el.style.left='50%';
      el.style.bottom='110px';
      el.style.transform='translateX(-50%)';
      el.style.padding='10px 14px';
      el.style.borderRadius='999px';
      el.style.background='rgba(0,0,0,.65)';
      el.style.border='1px solid rgba(255,255,255,.14)';
      el.style.color='#fff';
      el.style.zIndex='99';
      el.style.backdropFilter='blur(6px)';
      el.style.webkitBackdropFilter='blur(6px)';
      el.style.boxShadow='0 20px 40px rgba(0,0,0,.55)';
      document.body.appendChild(el);
      setTimeout(()=>{ el.style.opacity='0'; el.style.transition='opacity .25s'; }, 1400);
      setTimeout(()=> el.remove(), 1750);
    }

    // ===== Offline status =====
    function updateNet(){
      const online = navigator.onLine;
      $("#offlineStatus").textContent = online ? "online" : "offline";
    }
    window.addEventListener('online', updateNet);
    window.addEventListener('offline', updateNet);
    updateNet();

    // ===== Tabs =====
    const pages = {
      hoje: $("#page-hoje"),
      oracao: $("#page-oracao"),
      musica: $("#page-musica"),
      imagens: $("#page-imagens"),
      notas: $("#page-notas"),
      config: $("#page-config"),
    };

    function showTab(key){
      Object.entries(pages).forEach(([k, el])=>{
        el.classList.toggle('hidden', k !== key);
      });
      $$(".tab").forEach(t=>{
        t.classList.toggle('active', t.dataset.tab === key);
      });
      store.set("ui.lastTab", key);
    }

    $$(".tab").forEach(t=>{
      t.addEventListener('click', ()=> showTab(t.dataset.tab));
    });

    showTab(store.get("ui.lastTab","hoje"));

    // ===== HOJE: Versos + devocionais =====
    const verses = [
      { t: "‚ÄúDeixo-vos a paz, a minha paz vos dou; n√£o vo-la dou como o mundo a d√°.‚Äù", r:"Jo√£o 14:27", dTitle:"Devocional: Coragem", dText:"Coragem n√£o √© aus√™ncia de medo; √© fidelidade apesar do medo. D√™ o pr√≥ximo passo com Deus." },
      { t: "‚ÄúO Senhor √© o meu pastor; nada me faltar√°.‚Äù", r:"Salmo 23:1", dTitle:"Devocional: Confian√ßa", dText:"Quando Deus guia, at√© o vale tem prop√≥sito. Confie no cuidado dEle hoje." },
      { t: "‚ÄúPosso todas as coisas naquele que me fortalece.‚Äù", r:"Filipenses 4:13", dTitle:"Devocional: For√ßa", dText:"Voc√™ n√£o caminha sozinho. A for√ßa de Cristo sustenta quando a sua falha." },
      { t: "‚ÄúPorque eu bem sei os planos que tenho para v√≥s...‚Äù", r:"Jeremias 29:11", dTitle:"Devocional: Esperan√ßa", dText:"Deus escreve hist√≥ria com futuro e esperan√ßa, mesmo quando o presente parece confuso." },
      { t: "‚ÄúEntrega o teu caminho ao Senhor; confia nele, e ele o far√°.‚Äù", r:"Salmo 37:5", dTitle:"Devocional: Entrega", dText:"Entregar n√£o √© desistir: √© confiar a dire√ß√£o a Quem enxerga o fim desde o come√ßo." }
    ];

    let verseIndex = store.get("hoje.verseIndex", 0);

    function renderHoje(){
      const v = verses[verseIndex % verses.length];
      $("#verseText").textContent = v.t;
      $("#verseRef").textContent = v.r;
      $("#devTitle").textContent = v.dTitle;
      $("#devText").textContent = v.dText;

      // pend√™ncia (apenas visual)
      const done = store.get("plano.doneDays", 0);
      $("#pendencia").textContent = done >= 1 ? "Em dia" : "Pend√™ncia";
      $("#pendencia").style.color = done >= 1 ? "var(--good)" : "var(--warn)";
    }

    $("#btnTrocar").addEventListener('click', ()=>{
      verseIndex = (verseIndex + 1) % verses.length;
      store.set("hoje.verseIndex", verseIndex);
      renderHoje();
    });

    $("#btnCopiar").addEventListener('click', ()=>{
      const txt = `${$("#verseText").textContent}\n${$("#verseRef").textContent}\n\n${$("#devTitle").textContent}\n${$("#devText").textContent}`;
      copyText(txt);
    });

    $("#btnCompartilhar").addEventListener('click', async ()=>{
      const txt = `${$("#verseText").textContent}\n${$("#verseRef").textContent}\n\n${$("#devTitle").textContent}\n${$("#devText").textContent}`;
      try{
        if(navigator.share){
          await navigator.share({ title:"App Crist√£o", text: txt });
        }else{
          await copyText(txt);
        }
      }catch(e){
        await copyText(txt);
      }
    });

    // ===== Plano 30 dias =====
    function renderPlano(){
      let done = store.get("plano.doneDays", 0);
      done = Math.max(0, Math.min(30, done));
      const pct = Math.round((done/30)*100);
      $("#planoDia").textContent = (done+1 > 30 ? 30 : done+1);
      $("#planoPct").textContent = `${pct}%`;
    }

    $("#btnFeito").addEventListener('click', ()=>{
      let done = store.get("plano.doneDays", 0);
      if(done < 30) done++;
      store.set("plano.doneDays", done);
      renderPlano();
      renderHoje();
      toast("Dia marcado!");
    });

    $("#btnReiniciar").addEventListener('click', ()=>{
      store.set("plano.doneDays", 0);
      renderPlano();
      renderHoje();
      toast("Plano reiniciado.");
    });

    renderPlano();
    renderHoje();

    // ===== ORA√á√ÉO =====
    const prayVerses = [
      "‚ÄúN√£o andeis ansiosos por coisa alguma...‚Äù (Fp 4:6-7)",
      "‚ÄúClama a mim, e responder-te-ei...‚Äù (Jr 33:3)",
      "‚ÄúOrai sem cessar.‚Äù (1Ts 5:17)",
      "‚ÄúPerto est√° o Senhor dos que t√™m o cora√ß√£o quebrantado.‚Äù (Sl 34:18)",
      "‚ÄúTudo quanto pedirdes em ora√ß√£o, crendo, recebereis.‚Äù (Mt 21:22)"
    ];
    let prayVerseIndex = store.get("pray.verseIndex", 0);
    function renderPrayVerse(){
      $("#prayVerse").textContent = prayVerses[prayVerseIndex % prayVerses.length];
    }
    $("#btnNextPrayVerse").addEventListener('click', ()=>{
      prayVerseIndex = (prayVerseIndex + 1) % prayVerses.length;
      store.set("pray.verseIndex", prayVerseIndex);
      renderPrayVerse();
    });
    $("#btnCopyPrayVerse").addEventListener('click', ()=>{
      copyText($("#prayVerse").textContent);
    });
    renderPrayVerse();

    function getPrayers(){
      return store.get("prayers.items", []);
    }
    function setPrayers(items){
      store.set("prayers.items", items);
    }

    function renderPrayers(){
      const list = $("#prayerList");
      const items = getPrayers();

      if(items.length === 0){
        list.innerHTML = `<div class="hint">Sem pedidos ainda. Crie o primeiro acima üôè</div>`;
        return;
      }

      list.innerHTML = items.map((p,i)=>{
        const statusTag = p.answered ? `<span class="tag good">Respondido</span>` : `<span class="tag warn">Pendente</span>`;
        return `
          <div class="item">
            <div style="display:flex;gap:10px;align-items:flex-start;justify-content:space-between;">
              <div style="min-width:0;">
                <div style="font-size:16px;font-weight:800;margin:0 0 6px;">${escapeHtml(p.title || "Pedido")}</div>
                <div style="color:var(--muted);line-height:1.35;">${escapeHtml(p.text || "")}</div>
              </div>
              ${statusTag}
            </div>
            <div class="meta">
              <div>${fmtDate(p.createdAt)}</div>
              <div class="row">
                <button class="btn small ${p.answered ? "" : "good"}" data-act="toggle" data-i="${i}">${p.answered ? "Desmarcar" : "Marcar respondido"}</button>
                <button class="btn small" data-act="copy" data-i="${i}">Copiar</button>
                <button class="btn small" data-act="del" data-i="${i}">Excluir</button>
              </div>
            </div>
          </div>
        `;
      }).join("");

      // bind
      list.querySelectorAll("button").forEach(b=>{
        const i = +b.dataset.i;
        const act = b.dataset.act;
        b.addEventListener('click', ()=>{
          let items = getPrayers();
          if(act === "toggle"){
            items[i].answered = !items[i].answered;
            setPrayers(items);
            renderPrayers();
            toast(items[i].answered ? "Marcado como respondido!" : "Voltou para pendente.");
          }
          if(act === "copy"){
            const p = items[i];
            copyText(`üôè Pedido de ora√ß√£o\n${p.title}\n\n${p.text}`);
          }
          if(act === "del"){
            items.splice(i,1);
            setPrayers(items);
            renderPrayers();
            toast("Exclu√≠do.");
          }
        });
      });
    }

    $("#btnAddPrayer").addEventListener('click', ()=>{
      const title = $("#prayTitle").value.trim();
      const text = $("#prayText").value.trim();
      if(!title && !text){
        toast("Escreva um t√≠tulo ou pedido.");
        return;
      }
      const items = getPrayers();
      items.unshift({ title, text, answered:false, createdAt: nowISO() });
      setPrayers(items);
      $("#prayTitle").value="";
      $("#prayText").value="";
      renderPrayers();
      toast("Pedido salvo.");
    });

    $("#btnClearPrayerForm").addEventListener('click', ()=>{
      $("#prayTitle").value="";
      $("#prayText").value="";
      toast("Limpo.");
    });

    renderPrayers();

    // ===== M√öSICA =====
    function getMusic(){ return store.get("music.items", []); }
    function setMusic(items){ store.set("music.items", items); }

    function renderMusic(){
      const list = $("#musicList");
      const items = getMusic();
      if(items.length === 0){
        list.innerHTML = `<div class="hint">Sua playlist est√° vazia. Adicione um link mp3 acima üéµ</div>`;
        return;
      }
      list.innerHTML = items.map((m,i)=>`
        <div class="item">
          <div style="display:flex;gap:10px;align-items:flex-start;justify-content:space-between;">
            <div style="min-width:0;">
              <div style="font-size:16px;font-weight:800;margin:0 0 6px;">${escapeHtml(m.name || "M√∫sica")}</div>
              <div style="color:var(--muted);font-size:13px;word-break:break-all;">${escapeHtml(m.url)}</div>
            </div>
            <span class="tag">Playlist</span>
          </div>
          <div class="meta">
            <div>${fmtDate(m.createdAt)}</div>
            <div class="row">
              <button class="btn small good" data-act="play" data-i="${i}">Tocar</button>
              <button class="btn small" data-act="copy" data-i="${i}">Copiar link</button>
              <button class="btn small" data-act="del" data-i="${i}">Excluir</button>
            </div>
          </div>
        </div>
      `).join("");

      list.querySelectorAll("button").forEach(b=>{
        const i = +b.dataset.i;
        const act = b.dataset.act;
        b.addEventListener('click', ()=>{
          let items = getMusic();
          if(act==="play"){
            $("#player").src = items[i].url;
            $("#player").play().catch(()=>{});
            toast("Tocando‚Ä¶");
          }
          if(act==="copy"){
            copyText(items[i].url);
          }
          if(act==="del"){
            items.splice(i,1);
            setMusic(items);
            renderMusic();
            toast("Removido.");
          }
        });
      });
    }

    $("#btnAddMusic").addEventListener('click', ()=>{
      const name = $("#musicName").value.trim();
      const url = $("#musicUrl").value.trim();
      if(!url){
        toast("Cole um link mp3.");
        return;
      }
      const items = getMusic();
      items.unshift({ name: name || "M√∫sica", url, createdAt: nowISO() });
      setMusic(items);
      $("#musicName").value="";
      $("#musicUrl").value="";
      renderMusic();
      toast("Adicionado.");
    });

    $("#btnClearMusic").addEventListener('click', ()=>{
      $("#musicName").value="";
      $("#musicUrl").value="";
      toast("Limpo.");
    });

    renderMusic();

    // ===== IMAGENS (GALERIA) =====
    // üëâ Coloque AQUI todos os nomes das imagens que voc√™ subir na pasta /imagens
    const galleryItems = [
      {
        file: "C5782EF9-9488-4CB9-8285-C27D142A8118.png",
        title: "Arte 01"
      }
      // Quando voc√™ subir mais, adicione assim:
      // { file: "NOME-DA-IMAGEM.png", title: "Arte 02" },
    ];

    function renderGallery(){
      const g = $("#gallery");
      if(galleryItems.length === 0){
        g.innerHTML = `<div class="hint">Sem imagens ainda.</div>`;
        return;
      }
      g.innerHTML = galleryItems.map((it, idx)=>`
        <div class="gimg" data-i="${idx}">
          <img src="imagens/${it.file}" alt="${escapeHtml(it.title)}" loading="lazy">
          <div class="gcap">${escapeHtml(it.title)}<br><span style="opacity:.7;">imagens/${escapeHtml(it.file)}</span></div>
        </div>
      `).join("");

      g.querySelectorAll(".gimg").forEach(el=>{
        const i = +el.dataset.i;
        el.addEventListener('click', ()=>{
          const it = galleryItems[i];
          openModal(`imagens/${it.file}`, `${it.title} ‚Äî imagens/${it.file}`);
        });
      });
    }
    renderGallery();

    // ===== Modal =====
    const modal = $("#modal");
    function openModal(src, cap){
      $("#modalImg").src = src;
      $("#modalCap").textContent = cap;
      modal.classList.add("open");
    }
    function closeModal(){
      modal.classList.remove("open");
      $("#modalImg").src = "";
    }
    $("#btnCloseModal").addEventListener('click', closeModal);
    modal.addEventListener('click', (e)=>{
      if(e.target === modal) closeModal();
    });
    $("#btnCopyImgLink").addEventListener('click', ()=>{
      copyText($("#modalImg").src);
    });

    // ===== NOTAS =====
    function getNotes(){ return store.get("notes.items", []); }
    function setNotes(items){ store.set("notes.items", items); }

    function renderNotes(){
      const list = $("#notesList");
      const items = getNotes();
      if(items.length === 0){
        list.innerHTML = `<div class="hint">Sem notas ainda. Crie a primeira acima üìù</div>`;
        return;
      }
      list.innerHTML = items.map((n,i)=>`
        <div class="item">
          <div style="display:flex;gap:10px;align-items:flex-start;justify-content:space-between;">
            <div style="min-width:0;">
              <div style="font-size:16px;font-weight:900;margin:0 0 6px;">${escapeHtml(n.title || "Nota")}</div>
              <div style="color:var(--muted);white-space:pre-wrap;line-height:1.35;">${escapeHtml(n.text || "")}</div>
            </div>
            <span class="tag">Nota</span>
          </div>
          <div class="meta">
            <div>${fmtDate(n.createdAt)}</div>
            <div class="row">
              <button class="btn small" data-act="copy" data-i="${i}">Copiar</button>
              <button class="btn small" data-act="del" data-i="${i}">Excluir</button>
            </div>
          </div>
        </div>
      `).join("");

      list.querySelectorAll("button").forEach(b=>{
        const i = +b.dataset.i;
        const act = b.dataset.act;
        b.addEventListener('click', ()=>{
          let items = getNotes();
          if(act==="copy"){
            const n = items[i];
            copyText(`üìù ${n.title}\n\n${n.text}`);
          }
          if(act==="del"){
            items.splice(i,1);
            setNotes(items);
            renderNotes();
            toast("Exclu√≠do.");
          }
        });
      });
    }
    renderNotes();

    $("#btnSaveNote").addEventListener('click', ()=>{
      const title = $("#noteTitle").value.trim();
      const text  = $("#noteText").value.trim();
      if(!title && !text){
        toast("Escreva algo.");
        return;
      }
      const items = getNotes();
      items.unshift({ title: title || "Nota", text, createdAt: nowISO() });
      setNotes(items);
      $("#noteTitle").value="";
      $("#noteText").value="";
      renderNotes();
      toast("Nota salva.");
    });
    $("#btnClearNote").addEventListener('click', ()=>{
      $("#noteTitle").value="";
      $("#noteText").value="";
      toast("Limpo.");
    });

    // ===== CONFIG =====
    $("#btnResetAll").addEventListener('click', ()=>{
      if(!confirm("Tem certeza que quer apagar todos os dados do app?")) return;
      ["prayers.items","notes.items","music.items","plano.doneDays","hoje.verseIndex","ui.lastTab","pray.verseIndex"].forEach(k=>store.del(k));
      verseIndex = 0;
      prayVerseIndex = 0;
      renderHoje();
      renderPlano();
      renderPrayVerse();
      renderPrayers();
      renderNotes();
      renderMusic();
      showTab("hoje");
      toast("Tudo apagado.");
    });

    $("#btnExport").addEventListener('click', ()=>{
      const dump = {
        prayers: getPrayers(),
        notes: getNotes(),
        music: getMusic(),
        planoDone: store.get("plano.doneDays",0),
        verseIndex: store.get("hoje.verseIndex",0),
        exportedAt: nowISO()
      };
      copyText(JSON.stringify(dump, null, 2));
    });

    // ===== Escape HTML =====
    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // ===== PWA SW (opcional) =====
    // Se voc√™ tiver sw.js na raiz, isso registra.
    if('serviceWorker' in navigator){
      window.addEventListener('load', ()=>{
        navigator.serviceWorker.register('./sw.js').catch(()=>{});
      });
    }
  </script>
</body>
</html>
